#!/usr/bin/env ruby
# Command line utility to manage
# the zookeeper service registry
$:.unshift File.join(File.dirname(__FILE__), *%w[.. lib])

require 'rubygems'
require 'bundler/setup'
require 'zk-service-registry'

def service_list
  ZK::ServiceInstance.list_services.map{|s| {:name => s.name, :instances => s.instances.map{|i| i.name}} }
end

slc = []
loop do
  sl = service_list
  if sl != slc
    slc = sl
    p sl
  end
  sleep 1
end
